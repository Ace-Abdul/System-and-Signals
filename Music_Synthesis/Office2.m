%%  ECE 280 Lab 1 - Music Synthesis
%   "The Office" Theme Song
%   Author: Ace Abdulrahman
%   Emulated Sheet Music: https://musescore.com/user/22944241/scores/4875944

%% Declaring Note Variables
C4_2=m2(1,"C",2, 4);
A3_1=m2(1,"A",1, 3);
A3_2=m2(1,"A",2, 3);
A3_4=m2(1,"A",4, 3);
A3_8=m2(1,"A",8, 3);
A4_8=m2(1,"A",8, 4);
B3_1=m2(1,"B",1, 3);
B3_2=m2(1,"B",2, 3);
B3_4=m2(1,"B",4, 3);
B4_4=m2(1,"B",4, 4);
B3_8=m2(1,"B",8, 3);
C3_1=m2(1,"C",1, 3);
C3_2=m2(1,"C",2, 3);
C3_4=m2(1,"C",4, 3);
C4_4=m2(1,"C",4, 4);
C4_8=m2(1,"C",8, 4);
C3_8=m2(1,"C",8, 3);
D3_1=m2(1,"D",1, 3);
D3_2=m2(1,"D",2, 3);
D3_4=m2(1,"D",4, 3);
D3_8=m2(1,"D",8, 3);
E3_1=m2(1,"E",1, 3);
E3_2=m2(1,"E",2, 3);
E3_4=m2(1,"E",4, 3);
E4_4=m2(1,"E",4, 4);
E3_8=m2(1,"E",8, 3);
FS3_1=m2(1,"F#",1, 3);
FS3_2=m2(1,"F#",2, 3);
FS3_4=m2(1,"F#",4, 3);
FS3_8=m2(1,"F#",8, 3);
F3_1=m2(1,"F",1, 3);
F3_2=m2(1,"F",2, 3);
F3_4=m2(1,"F",4, 3);
F3_8=m2(1,"F",8, 3);
G3_1=m2(1,"G",1, 3);
G3_2=m2(1,"G",2, 3);
G3_4=m2(1,"G",4, 3);
G3_8=m2(1,"G",8, 3);
G4_1=m2(1,"G",1, 4);

C2_1=m2(1,"C",1, 2);
C2_2=m2(1,"C",2, 2);
C2_4=m2(1,"C",4, 2);
C2_8=m2(1,"C",8, 2);
D2_1=m2(1,"D",1, 2);
D2_2=m2(1,"D",2, 2);
D2_4=m2(1,"D",4, 2);
D2_8=m2(1,"D",8, 2);
E2_1=m2(1,"E",1, 2);
E2_2=m2(1,"E",2, 2);
E2_4=m2(1,"E",4, 2);
E2_8=m2(1,"E",8, 2);
F2_1=m2(1,"F#",1, 2);
F2_2=m2(1,"F#",2, 2);
F2_4=m2(1,"F#",4, 2);
F2_8=m2(1,"F#",8, 2);
G2_1=m2(1,"G",1, 2);
G2_2=m2(1,"G",2, 2);
G2_4=m2(1,"G",4, 2);
G4_1=m2(1,"G",1, 4);
G2_8=m2(1,"G",8, 2);

E2_34= m2(1,"E",4/3, 2);
E3_34= m2(1,"E",4/3, 3);
B2_4=m2(1,"B",4, 2);
B4_8=m2(1,"B",8, 4);
B2_8=m2(1,"B",8, 2);
D4_8=m2(1,"D",8, 4);
E4_8=m2(1,"E",8, 4);
G4_78=m2(1,"G",8/7, 4);
R1=m2(0.00,"C",1, 3)

%% Treble Clef
Song=[D3_8, G2_8, D3_2, D3_8, G2_8,             D3_8, F2_8, D3_2, D3_8, F2_8,         ...
      E3_8, G2_8, E3_2, E3_8, G2_8,             E3_4,  C3_4, C3_8, B3_8, A3_8, B3_8, ...
      D3_8, G2_8, D3_4, G3_4, D3_8, G2_8,       D3_8, F2_8, D3_8, G3_8, FS3_8, G3_8,FS3_8 D3_8, ...
      ...
      E3_8, G2_8, B3_2, B3_8, E3_8,             E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,         ...
      D3_8, G2_8, D3_4, G3_4,D3_8, G2_8,        D3_8, F2_8, D3_8, G3_8, FS3_8, G3_8,A4_8, FS3_8, ...
      E3_8, G2_8, B3_4, D3_8,E3_8 D3_8, E3_8,   E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,...
      ...
      D3_8, G2_8, D3_4, G3_2,                   G3_2, FS3_8,G3_8,FS3_8, D3_8,...
      E3_34,E3_8,G2_8,                          E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,...
      D3_8, G2_8, D3_4, G3_2,...
      ...
      G3_2, FS3_8,G3_8,A4_8, FS3_8,             E3_2, D3_8,E3_8,D3_8, B3_8,...
      E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,       G2_1,...
      D3_8, G3_8, D3_8, G3_8, B4_8, G3_8,B4_8, D4_8,     D4_8, G4_78];
  

Song2=[B3_8,G2_8, B3_2, B3_8, G2_8,             B3_8, F2_8, B3_2, B3_8, F2_8,         ...
      B3_8, G2_8, B3_2, B3_8, G2_8,             C3_4,  C3_4, C3_8, B3_8, A3_8, B3_8, ...
      D3_8, G2_8, D3_4, G3_4, B3_8, G2_8,       B3_8, F2_8, B3_8, G3_8, FS3_8, G3_8,D3_8 F2_8, ...
      ...
      B3_8, G2_8, B3_2, B3_8, G2_8,             C3_4, C3_4, C3_8, B3_8, A3_8, B3_8,         ...
      B3_8, G2_8, B3_4, G3_4, B3_8, G2_8,       B3_8, F2_8, B3_8, G3_8, FS3_8, G3_8,D3_8, F2_8, ...
      B3_8, G2_8, B3_4, D3_8, E3_8, D3_8,B3_8,  C3_4, E2_4, C3_8, B3_8, A3_8, B3_8,...
      ...
      B3_8, G2_8, B3_4, D3_2,                   D3_2, D3_8, D3_8, D3_8, G2_8,...
      E2_34,B3_8,G2_8,                          C3_4, E3_4, E2_8, B3_8, E2_8, B3_8,...
      B3_8, G2_8, B2_4, G2_2,...
      ...
      G2_2, D3_8, G3_8, D3_8, FS3_8,            E2_2, D3_8,E3_8,D3_8, G2_8,...
      C3_4, E2_4, E2_8, B3_8, E2_8, C3_8,       G2_1,...
      D3_8, G3_8, D3_8, G3_8, B4_8, G3_8,B4_8, D4_8,     D4_8, G4_78];


Song3=[D3_8, G2_8, D3_2, D3_8, G2_8,            D3_8, F2_8, D3_2, D3_8, F2_8,         ...
      E3_8, G2_8, E3_2, E3_8, G2_8,             E3_4,  C3_4, C3_8, B3_8, A3_8, B3_8, ...
      D3_8, G2_8, G2_4, G3_4, D3_8, G2_8,       D3_8, F2_8, D3_8, G3_8, FS3_8, G3_8, B3_8, D3_8,...
      ...
      E3_8, G2_8, B3_2, B3_8, E3_8,             E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,         ...
      D3_8, G2_8, G2_4, G3_4, D3_8,G2_8,        D3_8, F2_8, D3_8, G3_8, FS3_8, G3_8,B3_8, FS3_8, ...
      E3_8, G2_8, B3_4, D3_8,E3_8 D3_8, G2_8,   E2_4, C3_4, C3_8, B3_8, A3_8, B3_8...
      ...
      D3_8, G2_8, D3_4, G3_2,                   G3_2, FS3_8,G3_8,FS3_8, D3_8,...
      E3_34,E3_8,G2_8,                          E3_4, C3_4, C3_8, B3_8, A3_8, B3_8,...
      D3_8, G2_8, D3_4, G3_2,...
      ...
      G3_2, B3_8,G3_8,B3_8, FS3_8,             E3_2, D3_8,E3_8,D3_8, B3_8,...
      E2_4, C3_4, C3_8, B3_8, A3_8, B3_8,      G2_1,...
      D3_8, G3_8, D3_8, G3_8, B4_8, G3_8,B4_8, D4_8,     D4_8, G4_78];
  
  
 
%% Base Clef
Base=[G3_1,                         B3_1,...
      G4_1,                         C4_2, C4_2,...
      G3_4, G3_4, G3_4, G3_4,       B3_4, B3_4, B3_4, B3_4,...
      ...
      E4_4, E4_4, E4_4, E4_4,       C4_2, C4_2,...
      G3_4, G3_4, G3_4, G3_4,       B4_4, B4_4, B4_4, B4_4,...
      E4_4, E4_4, E4_4, E4_4,       C4_4, C4_4,C3_8,G3_8,C4_8,G3_8,...
      ...
      G2_8, G3_8, G2_8, D3_8, G2_8, G3_8, D4_8,G3_8,       B2_8, B3_8, B2_8, F3_8, B2_8, B3_8, E4_8, B3_8,...
      E2_8, E3_8, E2_8, B2_8, E2_8, E3_8, B3_8,E3_8,       C3_8, C4_8, C3_8, G3_8, C3_8, C4_8, G3_8,C4_8,...
      G2_8, G3_8, G2_8, D3_8, G2_8, G3_8, D4_8,G3_8,       ...
      ...
      B2_8, B3_8, B2_8, F3_8, B2_8, B3_8, E4_8, B3_8,      E2_8, E3_8, E2_8, B2_8, E2_8, E3_8, B3_8,E3_8,...
      C3_8, C4_8, C3_8, G3_8, C3_8, C4_8, G3_8,C4_8,       G3_1,...
      G3_1,                                                R1];

Base2=[G3_1,                        B3_1,...
      G4_1,                         C4_2, C4_2,...
      G3_4, G3_4, G3_4, G3_4,       B3_4, B3_4, B3_4, B3_4,...
      ...
      E4_4, E4_4, E4_4, E4_4,       G3_2, G3_2,...
      G3_4, G3_4, G3_4, G3_4,       B4_4, B4_4, B4_4, B4_4,...
      E4_4, E4_4, E4_4, E4_4,       C3_4, C3_4,C3_8,G3_8,C4_8,G3_8,....
      ...
      G2_8, G3_8, G2_8, D3_8, G2_8, G3_8, D4_8,G3_8,       B2_8, B3_8, B2_8, F3_8, B2_8, B3_8, E4_8, B3_8,...
      E2_8, E3_8, E2_8, B2_8, E2_8, E3_8, B3_8,E3_8,       C3_8, C4_8, C3_8, G3_8, C3_8, C4_8, G3_8,C4_8,...
      G2_8, G3_8, G2_8, D3_8, G2_8, G3_8, D4_8,G3_8,...
      ...
      B2_8, B3_8, B2_8, F3_8, B2_8, B3_8, E4_8, B3_8,      E2_8, E3_8, E2_8, B2_8, E2_8, E3_8, B3_8,E3_8,...
      C3_8, C4_8, C3_8, G3_8, C3_8, C4_8, G3_8,C4_8,       G2_1,...
      G2_1,                                                R1];
  
  
%% Normalizing Arrays
Song = Song / max(abs(Song))
Song2 = Song2 / max(abs(Song2))
Song3 = Song3 / max(abs(Song3))
Base = Base / (max(abs(Base))*18);
Base2 = Base2 / (max(abs(Base2))*20);

  
SongArr =(Song+Song2+Song3+Base+Base2);    
SongArr = SongArr / max(abs(SongArr));

%% Echo Effect
z3= zeros(1,900);                       % array of 900 zeros
one= [SongArr z3];                      % right padding
two= [z3 .4*SongArr];                   % left padding and reduction of amplitude
SA = one + two;                         % Echo
SA = SA/ max(abs(SA));                  % Further normalizing

%% Playing Song
soundsc(SA, 8000);

%% Creating .wav file
audiowrite("Ace_Sin_Office_Theme_280.wav", SA,8000)